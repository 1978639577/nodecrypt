import{e,s as t,a as n,c as s}from"./crypto-libs-Biap7jvT.js";import{b as i}from"./vendor-Cez3xphJ.js";import"./emoji-libs-WM5lT91j.js";import{c as o,d as r}from"./avatar-libs-exuC_fCG.js";import{p as a}from"./vendor-deps-CUoVodhr.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}(),window.Buffer=i.Buffer;class c{constructor(t={},n={}){this.config={rsaPublic:t.rsaPublic||"",wsAddress:t.wsAddress||"",reconnectDelay:t.reconnectDelay||3e3,pingInterval:t.pingInterval||2e4,debug:t.debug||!1},this.callbacks={onServerClosed:n.onServerClosed||null,onServerSecured:n.onServerSecured||null,onClientSecured:n.onClientSecured||null,onClientList:n.onClientList||null,onClientMessage:n.onClientMessage||null},this.SERVER_KEY_STORAGE="nodecrypt_server_key";try{this.clientEc=new e.ec("curve25519")}catch(s){this.logEvent("constructor",s,"error")}this.serverKeys=null,this.serverShared=null,this.credentials=null,this.connection=null,this.reconnect=null,this.ping=null,this.channel={},this.setCredentials=this.setCredentials.bind(this),this.connect=this.connect.bind(this),this.destruct=this.destruct.bind(this),this.onOpen=this.onOpen.bind(this),this.onMessage=this.onMessage.bind(this),this.onError=this.onError.bind(this),this.onClose=this.onClose.bind(this),this.logEvent=this.logEvent.bind(this),this.isOpen=this.isOpen.bind(this),this.isClosed=this.isClosed.bind(this),this.startReconnect=this.startReconnect.bind(this),this.stopReconnect=this.stopReconnect.bind(this),this.startPing=this.startPing.bind(this),this.stopPing=this.stopPing.bind(this),this.disconnect=this.disconnect.bind(this),this.sendMessage=this.sendMessage.bind(this),this.sendChannelMessage=this.sendChannelMessage.bind(this),this.encryptServerMessage=this.encryptServerMessage.bind(this),this.decryptServerMessage=this.decryptServerMessage.bind(this),this.encryptClientMessage=this.encryptClientMessage.bind(this),this.decryptClientMessage=this.decryptClientMessage.bind(this)}setCredentials(e,n,s){this.logEvent("setCredentials");try{this.credentials={username:e,channel:t.sha256(n),password:t.sha256(s)}}catch(i){return this.logEvent("setCredentials",i,"error"),!1}return!0}connect(){if(!this.credentials)return!1;this.logEvent("connect",this.config.wsAddress),this.stopReconnect(),this.stopPing(),this.serverKeys=null,this.serverShared=null,this.channel={};try{this.connection=new WebSocket(this.config.wsAddress),this.connection.onopen=this.onOpen,this.connection.onmessage=this.onMessage,this.connection.onerror=this.onError,this.connection.onclose=this.onClose}catch(e){return this.logEvent("connect",e,"error"),!1}return!0}destruct(){this.logEvent("destruct"),this.stopReconnect(),this.stopPing(),this.reconnect=null,this.ping=null,this.config={rsaPublic:"",wsAddress:"",reconnectDelay:3e3,pingInterval:15e3,debug:!1},this.callbacks.onServerClosed=null,this.callbacks.onServerSecured=null,this.callbacks.onClientSecured=null,this.callbacks.onClientList=null,this.callbacks.onClientMessage=null,this.clientEc=null,this.serverKeys=null,this.serverShared=null,this.credentials=null,this.connection.onopen=null,this.connection.onmessage=null,this.connection.onerror=null,this.connection.onclose=null;try{this.connection.removeAllListeners()}catch(e){this.logEvent("destruct",e,"error")}try{this.connection.close()}catch(e){this.logEvent("destruct",e,"error")}return this.connection=null,this.channel={},!0}async onOpen(){this.logEvent("onOpen"),this.startPing();try{this.serverKeys=await crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-384"},!1,["deriveKey","deriveBits"]),this.serverShared=null,this.sendMessage(i.Buffer.from(await crypto.subtle.exportKey("raw",this.serverKeys.publicKey)).toString("hex"))}catch(e){this.logEvent("onOpen",e,"error")}}async onMessage(e){if(!e||!this.isString(e.data))return;if("pong"===e.data)return;this.logEvent("onMessage",e.data);try{const t=JSON.parse(e.data);if("server-key"===t.type){if(!(await this.handleServerKey(t.key)))return}}catch(n){}if(!this.serverShared){const t=e.data.split("|");if(!t[0]||!t[1])return;try{if(!0===await crypto.subtle.verify({name:"RSASSA-PKCS1-v1_5"},await crypto.subtle.importKey("spki",i.Buffer.from(this.config.rsaPublic,"base64"),{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]),i.Buffer.from(t[1],"base64"),i.Buffer.from(t[0],"hex"))&&(this.serverShared=i.Buffer.from(await crypto.subtle.deriveBits({name:"ECDH",namedCurve:"P-384",public:await crypto.subtle.importKey("raw",i.Buffer.from(t[0],"hex"),{name:"ECDH",namedCurve:"P-384"},!0,[])},this.serverKeys.privateKey,384)).slice(8,40),this.sendMessage(this.encryptServerMessage({a:"j",p:this.credentials.channel},this.serverShared)),this.callbacks.onServerSecured))try{this.callbacks.onServerSecured()}catch(s){this.logEvent("onMessage-server-secured-callback",s,"error")}}catch(s){this.logEvent("onMessage",s,"error")}return}const t=this.decryptServerMessage(e.data,this.serverShared);if(this.logEvent("onMessage-server-decrypted",t),this.isObject(t)&&this.isString(t.a))if("l"===t.a&&this.isArray(t.p)){try{for(const n in this.channel)t.p.indexOf(n)<0&&delete this.channel[n];let e={};for(const n of t.p)this.channel[n]||(this.channel[n]={username:null,keys:this.clientEc.genKeyPair(),shared:null},e[n]=this.channel[n].keys.getPublic("hex"));Object.keys(e).length>0&&this.sendMessage(this.encryptServerMessage({a:"w",p:e},this.serverShared))}catch(s){this.logEvent("onMessage-list",s,"error")}if(this.callbacks.onClientList){let e=[];for(const t in this.channel)this.channel[t].shared&&this.channel[t].username&&e.push({clientId:t,username:this.channel[t].username});try{this.callbacks.onClientList(e)}catch(s){this.logEvent("onMessage-client-list-callback",s,"error")}}}else if(this.isString(t.p)&&this.isString(t.c))if("c"!==t.a||this.channel[t.c]&&this.channel[t.c].shared){if("c"===t.a&&this.channel[t.c]&&this.channel[t.c].shared){const e=this.decryptClientMessage(t.p,this.channel[t.c].shared);if(this.logEvent("onMessage-client-decrypted",e),!this.isObject(e)||!this.isString(e.a))return;if("u"===e.a&&this.isString(e.p)&&e.p.match(/\S+/)&&!this.channel[t.c].username){if(this.channel[t.c].username=e.p.replace(/^\s+/,"").replace(/\s+$/,""),this.callbacks.onClientSecured)try{this.callbacks.onClientSecured({clientId:t.c,username:this.channel[t.c].username})}catch(s){this.logEvent("onMessage-client-secured-callback",s,"error")}return}if(!this.channel[t.c].username)return;if("m"===e.a&&this.isString(e.t)&&this.isString(e.d)){if(this.callbacks.onClientMessage)try{this.callbacks.onClientMessage({clientId:t.c,username:this.channel[t.c].username,type:e.t,data:e.d})}catch(s){this.logEvent("onMessage-client-message-callback",s,"error")}return}}}else try{this.channel[t.c]||(this.channel[t.c]={username:null,keys:this.clientEc.genKeyPair(),shared:null},this.sendMessage(this.encryptServerMessage({a:"c",p:this.channel[t.c].keys.getPublic("hex"),c:t.c},this.serverShared))),this.channel[t.c].shared=i.Buffer.from(this.xorHex(this.channel[t.c].keys.derive(this.clientEc.keyFromPublic(t.p,"hex").getPublic()).toString("hex").padEnd(64,"8").substr(0,64),this.credentials.password),"hex"),this.sendMessage(this.encryptServerMessage({a:"c",p:this.encryptClientMessage({a:"u",p:this.credentials.username},this.channel[t.c].shared),c:t.c},this.serverShared))}catch(s){this.logEvent("onMessage-client",s,"error")}}async onError(e){if(this.logEvent("onError",e,"error"),this.disconnect(),this.credentials&&this.startReconnect(),this.callbacks.onServerClosed)try{this.callbacks.onServerClosed()}catch(t){this.logEvent("onError-server-closed-callback",t,"error")}}async onClose(e){if(this.logEvent("onClose",e),this.disconnect(),this.credentials&&this.startReconnect(),this.callbacks.onServerClosed)try{this.callbacks.onServerClosed()}catch(t){this.logEvent("onClose-server-closed-callback",t,"error")}}logEvent(e,t,n){if(this.config.debug){const s=new Date,i=s.getFullYear()+"-"+("0"+(s.getMonth()+1)).slice(-2)+"-"+("0"+s.getDate()).slice(-2)+" "+("0"+s.getHours()).slice(-2)+":"+("0"+s.getMinutes()).slice(-2)+":"+("0"+s.getSeconds()).slice(-2);console.log("["+i+"]",n?n.toUpperCase():"INFO",e+(t?":":""),t||"")}}isOpen(){return!(!this.connection||!this.connection.readyState||this.connection.readyState!==WebSocket.OPEN)}isClosed(){return!this.connection||!this.connection.readyState||this.connection.readyState===WebSocket.CLOSED}startReconnect(){this.stopReconnect(),this.logEvent("startReconnect"),this.reconnect=setTimeout((()=>{this.reconnect=null,this.connect()}),this.config.reconnectDelay)}stopReconnect(){this.reconnect&&(this.logEvent("stopReconnect"),clearTimeout(this.reconnect),this.reconnect=null)}startPing(){this.stopPing(),this.logEvent("startPing"),this.ping=setInterval((()=>{this.sendMessage("ping")}),this.config.pingInterval)}stopPing(){this.ping&&(this.logEvent("stopPing"),clearInterval(this.ping),this.ping=null)}disconnect(){if(this.stopReconnect(),this.stopPing(),!this.isClosed())try{this.logEvent("disconnect"),this.connection.close()}catch(e){this.logEvent("disconnect",e,"error")}}sendMessage(e){try{if(this.isOpen())return this.connection.send(e),!0}catch(t){this.logEvent("sendMessage",t,"error")}return!1}sendChannelMessage(e,t){if(this.serverShared)try{let n={};for(const s in this.channel)if(this.channel[s].shared&&this.channel[s].username&&(n[s]=this.encryptClientMessage({a:"m",t:e,d:t},this.channel[s].shared),0===n[s].length))return!1;if(Object.keys(n).length>0){const e=this.encryptServerMessage({a:"w",p:n},this.serverShared);if(!this.isOpen()||0===e.length||e.length>8388608)return!1;this.connection.send(e)}return!0}catch(n){this.logEvent("sendChannelMessage",n,"error")}return!1}encryptServerMessage(e,t){let s="";try{(e=i.Buffer.from(JSON.stringify(e),"utf8")).length%16!=0&&(e=i.Buffer.from([...e,...i.Buffer.alloc(16-e.length%16)]));const o=i.Buffer.from(crypto.getRandomValues(new Uint8Array(16))),r=new n.ModeOfOperation.cbc(t,o);s=o.toString("base64")+"|"+i.Buffer.from(r.encrypt(e)).toString("base64")}catch(o){this.logEvent("encryptServerMessage",o,"error")}return s}decryptServerMessage(e,t){let s={};try{const o=e.split("|"),r=new n.ModeOfOperation.cbc(t,i.Buffer.from(o[0],"base64"));s=JSON.parse(i.Buffer.from(r.decrypt(i.Buffer.from(o[1],"base64"))).toString("utf8").replace(/\0+$/,""))}catch(o){this.logEvent("decryptServerMessage",o,"error")}return s}encryptClientMessage(e,t){let n="";try{(e=i.Buffer.from(JSON.stringify(e),"utf8")).length%16!=0&&(e=i.Buffer.from([...e,...i.Buffer.alloc(16-e.length%16)]));const o=i.Buffer.from(crypto.getRandomValues(new Uint8Array(12))),r=i.Buffer.from(crypto.getRandomValues(new Uint8Array(4))),a=new s(t,o,r.reduce(((e,t)=>e*t)));n=o.toString("base64")+"|"+r.toString("base64")+"|"+i.Buffer.from(a.encrypt(e)).toString("base64")}catch(o){this.logEvent("encryptClientMessage",o,"error")}return n}decryptClientMessage(e,t){let n={};try{const o=e.split("|"),r=new s(t,i.Buffer.from(o[0],"base64"),i.Buffer.from(o[1],"base64").reduce(((e,t)=>e*t)));n=JSON.parse(i.Buffer.from(r.decrypt(i.Buffer.from(o[2],"base64"))).toString("utf8").replace(/\0+$/,""))}catch(o){this.logEvent("decryptClientMessage",o,"error")}return n}xorHex(e,t){let n="",s=Math.min(e.length,t.length);for(let i=0;i<s;++i)n+=(parseInt(e.charAt(i),16)^parseInt(t.charAt(i),16)).toString(16);return n}isString(e){return!(!e||"[object String]"!==Object.prototype.toString.call(e))}isArray(e){return!(!e||"[object Array]"!==Object.prototype.toString.call(e))}isObject(e){return!(!e||"[object Object]"!==Object.prototype.toString.call(e))}async handleServerKey(e){return this.logEvent("handleServerKey","Received server key"),localStorage.removeItem(this.SERVER_KEY_STORAGE),localStorage.setItem(this.SERVER_KEY_STORAGE,e),this.config.rsaPublic=e,!0}}function l(e,t=document){return t.querySelector(e)}function d(e){return document.getElementById(e)}function u(e,t={},n=""){const s=document.createElement(e);return Object.entries(t).forEach((([e,t])=>{"class"===e||"className"===e?s.className=t:"style"===e&&"object"==typeof t?Object.assign(s.style,t):e.startsWith("on")&&"function"==typeof t?s.addEventListener(e.slice(2).toLowerCase(),t):s.setAttribute(e,t)})),"string"==typeof n?s.innerHTML=n:n instanceof Element&&s.appendChild(n),s}function h(e,t,n,s){const i="string"==typeof e?l(e):e;i&&i.addEventListener(t,n,s)}function p(e,...t){e.classList.add(...t)}function m(e,...t){e.classList.remove(...t)}async function g(e,t){const n=new Image;n.onload=function(){let e=n.naturalWidth,s=n.naturalHeight;if(e>1280||s>1280){const t=Math.min(1280/e,1280/s);e=Math.round(e*t),s=Math.round(s*t)}const i=u("canvas");i.width=e,i.height=s;let o;i.getContext("2d").drawImage(n,0,0,e,s),o=i.toDataURL("image/webp",.8),t(o)};const s=new FileReader;s.onload=function(e){n.src=e.target.result},s.readAsDataURL(e)}function f(e){return{tooLarge:"Image is too large (over 5MB)"}[e]}"undefined"!=typeof window&&(window.NodeCrypt=c);function v({btnSelector:e=".chat-emoji-btn",inputSelector:t=".input-message-input"}={}){const n=l(e),s=l(t);if(n&&s)try{let e=function(){o.style.display="block",o.offsetHeight,o.classList.add("show")},t=function(){o.classList.remove("show"),setTimeout((()=>{o.style.display="none"}),300)};(()=>{if(document.querySelector("#emoji-picker-styles"))return;const e=document.createElement("style");e.id="emoji-picker-styles",e.textContent='emoji-picker{--background:#fff;--border-color:rgba(0,0,0,0.1);--border-radius:10px;--emoji-padding:0.4rem;--category-emoji-size:1.2rem;--font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;position:absolute;bottom:60px;left:22px;z-index:5;box-shadow:0 3px 12px rgba(0,0,0,0.15);width:320px;display:none;opacity:0;transform:translateY(-10px) scale(0.95);transition:opacity 0.3s ease,transform 0.3s ease}emoji-picker.show{opacity:1;transform:translateY(0) scale(1)}',document.head.appendChild(e)})();const i=l("emoji-picker",n.parentNode);i&&i.remove();const o=document.createElement("emoji-picker");o.style.display="none",n.parentNode.style.position="relative",n.parentNode.appendChild(o),o.addEventListener("emoji-click",(e=>{!function(e,t){if(e.focus(),document.getSelection&&window.getSelection){let e=window.getSelection();if(!e.rangeCount)return;let n=e.getRangeAt(0);n.deleteContents(),n.insertNode(document.createTextNode(t)),n.collapse(!1),e.removeAllRanges(),e.addRange(n)}else e.innerText+=t;e.dispatchEvent(new Event("input"))}(s,e.detail.unicode),t()})),h(n,"click",(n=>{n.stopPropagation(),"none"===o.style.display?e():t()})),h(document,"click",(e=>{o.contains(e.target)||e.target===n||t()})),console.log("Emoji picker initialized successfully")}catch(i){console.error("Failed to initialize emoji picker:",i)}}const y={notify:!1,sound:!1};function b(){let e=localStorage.getItem("settings");try{e=e?JSON.parse(e):{}}catch{e={}}return{...y,...e}}function w(e){const{notify:t,sound:n}=e;localStorage.setItem("settings",JSON.stringify({notify:t,sound:n}))}function S(e){document.documentElement.lang="en"}function C(){let e=d("settings-panel");e||(e=u("div",{id:"settings-panel",class:"settings-panel"},'<div class="settings-panel-card"><div class="settings-title">Settings</div><div class="settings-item"><span>Desktop Notification</span><label class="switch"><input type="checkbox"id="settings-notify"><span class="slider"></span></label></div><div class="settings-item"><span>Sound Notification</span><label class="switch"><input type="checkbox"id="settings-sound"><span class="slider"></span></label></div></div>'),document.body.appendChild(e));const t=b(),n=l("#settings-notify",e),s=l("#settings-sound",e);n&&(n.checked=!!t.notify),s&&(s.checked=!!t.sound),h(n,"change",(n=>{if(n.target.checked){if(!("Notification"in window))return alert("Notifications are not supported by your browser."),void(n.target.checked=!1);i=i=>{"granted"===i?(t.notify=!0,t.sound=!1,s&&(s.checked=!1),w(t),S(),e._notificationShown||(new Notification("Notifications enabled",{body:"You will receive alerts here."}),e._notificationShown=!0)):(t.notify=!1,n.target.checked=!1,w(t),S(),alert("Please allow notifications in your browser settings."))},0===Notification.requestPermission.length?Notification.requestPermission().then(i):Notification.requestPermission(i)}else t.notify=!1,w(t),S(),e._notificationShown&&(e._notificationShown=!1);var i})),h(s,"change",(e=>{t.sound=e.target.checked,t.sound&&(t.notify=!1,n&&(n.checked=!1)),w(t),S()}))}function E(e){return e.length>100?e.slice(0,100)+"...":e}const M=["f87171","fb923c","09acf4","fb923c","f472b6","a78bfa","34d399"];function k(e){let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return M[Math.abs(t)%M.length]}function L(e){return o(r,{seed:e,baseColor:["f7e1c3","f9c9b6","f2d6cb","f8ce8e","eac393"],backgroundColor:[k(e)]}).toString()}function x(e){return"string"!=typeof e?"":e.replace(/[&<>"']/g,(function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[e]}))}function I(e){if("string"!=typeof e)return"";const t=x(e).replace(/\n/g,"<br>");return a.sanitize(t,{ALLOWED_TAGS:["br"],ALLOWED_ATTR:[]})}function N(){const e=d("chat-area");e&&(z<0||!G[z]?e.innerHTML="":(e.innerHTML="",G[z].messages.forEach((e=>{"me"===e.type?T(e.text,!0,e.msgType||"text",e.timestamp):"system"===e.type?R(e.text,!0,e.timestamp):function(e,t="",n="",s=!1,i="text",o=null){if(!t&&z>=0){const n=G[z];n&&e&&e.clientId&&n.userMap[e.clientId]&&(t=n.userMap[e.clientId].userName||n.userMap[e.clientId].username||n.userMap[e.clientId].name||"Anonymous")}t=t||"Anonymous";let r=s?o:o||Date.now();!s&&z>=0&&G[z].messages.push({type:"other",text:e,userName:t,avatar:n,msgType:i,timestamp:r});if(!r)return;const a=d("chat-area");if(!a)return;const c=u("div",{class:"bubble-other-wrap"});let h="";if("image"===i||"image_private"===i){h=`<img src="${x(e).replace(/javascript:/gi,"")}"alt="image"class="bubble-img">`}else h=I(e);const p=x(t),m=new Date(r),g=m.getHours().toString().padStart(2,"0")+":"+m.getMinutes().toString().padStart(2,"0");let f="bubble other";i&&i.includes("_private")&&(f+=" private-message");c.innerHTML=`<span class="avatar"></span><div class="bubble-other-main"><div class="${f}"><div class="bubble-other-name">${p}</div><span class="bubble-content">${h}</span><span class="bubble-meta">${g}</span></div></div>`;const v=L(t),y=l(".avatar",c);if(y){const e=v.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");y.innerHTML=e}a.appendChild(c),a.scrollTop=a.scrollHeight}(e.text,e.userName,e.avatar,!0,e.msgType||"text",e.timestamp)}))))}function T(e,t=!1,n="text",s=null){let i=t?s:s||Date.now();if(!i)return;!t&&z>=0&&G[z].messages.push({type:"me",text:e,msgType:n,timestamp:i});const o=d("chat-area");if(!o)return;const r="bubble me"+(n.includes("_private")?" private-message":""),a=new Date(i),c=a.getHours().toString().padStart(2,"0")+":"+a.getMinutes().toString().padStart(2,"0");let l="";if("image"===n||"image_private"===n){l=`<img src="${x(e).replace(/javascript:/gi,"")}"alt="image"class="bubble-img">`}else l=I(e);const h=u("div",{class:r},`<span class="bubble-content">${l}</span><span class="bubble-meta">${c}</span>`);o.appendChild(h),o.scrollTop=o.scrollHeight}function R(e,t=!1,n=null){if(!t&&z>=0){const t=n||Date.now();G[z].messages.push({type:"system",text:e,timestamp:t})}const s=d("chat-area");if(!s)return;const i=u("div",{class:"bubble system"},`<span class="bubble-content">${I(e)}</span>`);s.appendChild(i),s.scrollTop=s.scrollHeight}function B(){const e=G[z],t=l(".chat-input-area"),n=l(".input-field-placeholder"),s=l(".input-message-input");if(!t||!n||!s)return;e&&e.privateChatTargetId?(p(t,"private-mode"),p(s,"private-mode"),n.textContent=`Private Message to ${x(e.privateChatTargetName)}`):(m(t,"private-mode"),m(s,"private-mode"),n.textContent="Message");const i=s.innerHTML.replace(/<br\s*\/?>(\s*)?/gi,"").replace(/&nbsp;/g,"").replace(/\u200B/g,"").trim();n.style.opacity=""===i?"1":"0"}function O(){h(d("chat-area"),"click",(function(e){const t=e.target;"IMG"===t.tagName&&t.closest(".bubble-content")&&function(e){const t=u("div",{class:"img-modal-bg"},`<div class="img-modal-blur"></div><div class="img-modal-content img-modal-content-overflow"><img src="${e}"class="img-modal-img"/><span class="img-modal-close">&times;</span></div>`);document.body.appendChild(t),h(l(".img-modal-close",t),"click",(()=>t.remove())),h(t,"click",(e=>{e.target===t&&t.remove()}));const n=l("img",t);let s=1,i=!1,o=0,r=0,a=0,c=0;function d(){n.style.transform=`translate(${a}px,${c}px)scale(${s})`,n.style.cursor=s>1?i?"grabbing":"grab":"zoom-in"}function p(e){i&&(a+=e.clientX-o,c+=e.clientY-r,o=e.clientX,r=e.clientY,d())}function m(){i&&(i=!1,n.style.cursor="grab",document.body.style.userSelect="")}n.ondragstart=function(e){e.preventDefault()},h(n,"wheel",(function(e){e.preventDefault(),s+=e.deltaY<0?.1:-.1,s=Math.max(.2,Math.min(5,s)),1===s&&(a=0,c=0),d()})),h(n,"mousedown",(function(e){s<=1||(i=!0,o=e.clientX,r=e.clientY,n.style.cursor="grabbing",document.body.style.userSelect="none")})),h(window,"mousemove",p),h(window,"mouseup",m),h(n,"dblclick",(function(){s=1,a=0,c=0,d()}));const g=()=>{off(window,"mousemove",p),off(window,"mouseup",m),document.body.style.userSelect=""};h(t,"remove",g),h(l(".img-modal-close",t),"click",g),d()}(t.src)}))}function P(){const e=l(".input-message-input");e&&(e.style.height="auto",e.style.height=e.scrollHeight+"px")}function $(){const e=l(".input-message-input"),t=l(".input-field-placeholder");var n;e&&t&&(h(e,"input",s),h(e,"blur",s),h(e,"focus",s),(n=e)&&h(n,"paste",(function(e){e.preventDefault();let t="";if((e.clipboardData||window.clipboardData)&&(t=(e.clipboardData||window.clipboardData).getData("text/plain")),document.queryCommandSupported("insertText"))document.execCommand("insertText",!1,t);else{const e=window.getSelection();if(e.rangeCount){const n=e.getRangeAt(0);n.deleteContents();const s=document.createTextNode(t);n.insertNode(s),n.setStartAfter(s),n.setEndAfter(s),e.removeAllRanges(),e.addRange(n)}}})),s(),P(),B());function s(){const n=e.innerHTML.replace(/<br\s*\/?>(\s*)?/gi,"").replace(/&nbsp;/g,"").replace(/\u200B/g,"").trim();t.style.opacity=""===n?"1":"0",P()}}function A(){const e=G[z];let t=e?e.roomName:"Room",n=e&&e.userList?e.userList.length:0;e&&!e.userList.some((t=>t.clientId===e.myId))&&(n+=1);const s=x(t);d("main-header").innerHTML=`<button class="mobile-menu-btn"id="mobile-menu-btn"aria-label="Open Sidebar"><svg width="35px"height="35px"viewBox="0 0 24 24"fill="none"xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier"stroke-width="0"></g><g id="SVGRepo_tracerCarrier"stroke-linecap="round"stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path fill-rule="evenodd"clip-rule="evenodd"d="M21.4498 10.275L11.9998 3.1875L2.5498 10.275L2.9998 11.625H3.7498V20.25H20.2498V11.625H20.9998L21.4498 10.275ZM5.2498 18.75V10.125L11.9998 5.0625L18.7498 10.125V18.75H14.9999V14.3333L14.2499 13.5833H9.74988L8.99988 14.3333V18.75H5.2498ZM10.4999 18.75H13.4999V15.0833H10.4999V18.75Z"fill="#808080"></path></g></svg></button><div class="main-header-center"id="main-header-center"><div class="main-header-flex"><div class="group-title group-title-bold">#${s}</div><span class="main-header-members">${n}members</span></div></div><div class="main-header-actions"><button class="more-btn"id="more-btn"aria-label="More Options"><svg width="35px"height="35px"viewBox="0 0 24 24"fill="none"xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier"stroke-width="0"></g><g id="SVGRepo_tracerCarrier"stroke-linecap="round"stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><circle cx="12"cy="6"r="1.5"fill="#808080"></circle><circle cx="12"cy="12"r="1.5"fill="#808080"></circle><circle cx="12"cy="18"r="1.5"fill="#808080"></circle></g></svg></button><button class="mobile-info-btn"id="mobile-info-btn"aria-label="Open Members"><svg width="35px"height="35px"viewBox="0 0 24 24"fill="none"xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier"stroke-width="0"></g><g id="SVGRepo_tracerCarrier"stroke-linecap="round"stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path fill-rule="evenodd"clip-rule="evenodd"d="M16.0603 18.307C14.89 19.0619 13.4962 19.5 12 19.5C10.5038 19.5 9.10996 19.0619 7.93972 18.307C8.66519 16.7938 10.2115 15.75 12 15.75C13.7886 15.75 15.3349 16.794 16.0603 18.307ZM17.2545 17.3516C16.2326 15.5027 14.2632 14.25 12 14.25C9.73663 14.25 7.76733 15.5029 6.74545 17.3516C5.3596 15.9907 4.5 14.0958 4.5 12C4.5 7.85786 7.85786 4.5 12 4.5C16.1421 4.5 19.5 7.85786 19.5 12C19.5 14.0958 18.6404 15.9908 17.2545 17.3516ZM21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12ZM12 12C13.2426 12 14.25 10.9926 14.25 9.75C14.25 8.50736 13.2426 7.5 12 7.5C10.7574 7.5 9.75 8.50736 9.75 9.75C9.75 10.9926 10.7574 12 12 12ZM12 13.5C14.0711 13.5 15.75 11.8211 15.75 9.75C15.75 7.67893 14.0711 6 12 6C9.92893 6 8.25 7.67893 8.25 9.75C8.25 11.8211 9.92893 13.5 12 13.5Z"fill="#808080"></path></g></svg></button><div class="more-menu"id="more-menu"><div class="more-menu-item"data-action="share">Share</div><div class="more-menu-item"data-action="exit">Quit</div></div></div>`,_(),function(){const e=document.getElementById("sidebar"),t=document.getElementById("rightbar"),n=document.getElementById("mobile-menu-btn"),s=document.getElementById("mobile-info-btn"),i=document.getElementById("mobile-sidebar-mask"),o=document.getElementById("mobile-rightbar-mask");function r(){return window.innerWidth<=768}function a(){r()?(n&&(n.style.display="flex"),s&&(s.style.display="flex")):(n&&(n.style.display="none"),s&&(s.style.display="none"),e&&e.classList.remove("mobile-open"),t&&t.classList.remove("mobile-open"),i&&i.classList.remove("active"),o&&o.classList.remove("active"))}a(),window.addEventListener("resize",a),n&&e&&i&&(n.onclick=function(t){t.stopPropagation(),e.classList.add("mobile-open"),i.classList.add("active")},i.onclick=function(){e.classList.remove("mobile-open"),i.classList.remove("active")});s&&t&&o&&(s.onclick=function(e){e.stopPropagation(),t.classList.add("mobile-open"),o.classList.add("active")},o.onclick=function(){t.classList.remove("mobile-open"),o.classList.remove("active")});document.addEventListener("click",(function(a){r()&&(e&&e.classList.contains("mobile-open")&&(e.contains(a.target)||a.target===n||(e.classList.remove("mobile-open"),i&&i.classList.remove("active"))),t&&t.classList.contains("mobile-open")&&(t.contains(a.target)||a.target===s||(t.classList.remove("mobile-open"),o&&o.classList.remove("active"))))}))}()}function j(e=!1){const t=d("member-list");if(!t)return;t.innerHTML="";const n=G[z];if(!n)return;const s=n.userList.find((e=>e.clientId===n.myId)),i=n.userList.filter((e=>e.clientId!==n.myId));s&&t.appendChild(H(s,!0)),i.forEach((e=>t.appendChild(H(e,!1)))),e&&A()}function H(e,t){const n=document.createElement("div"),s=G[z],i=s&&e.clientId===s.privateChatTargetId;n.className="member"+(t?" me":"")+(i?" private-chat-active":"");const o=e.userName||e.username||e.name||"",r=x(o);n.innerHTML=`<span class="avatar"></span><div class="member-info"><div class="member-name">${r}${t?" (me)":""}</div></div>`;const a=n.querySelector(".avatar");if(a){const e=L(o).replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");a.innerHTML=e}return t||(n.onclick=()=>function(e,t){const n=G[z];if(!n)return;n.privateChatTargetId===e?(n.privateChatTargetId=null,n.privateChatTargetName=null):(n.privateChatTargetId=e,n.privateChatTargetName=t);j(),B()}(e.clientId,r)),n}function _(){const e=d("more-btn"),t=d("more-menu");if(!e||!t)return;let n=!1;function s(){n||(n=!0,t.classList.remove("open"),t.classList.add("close"),setTimeout((()=>{t.classList.contains("close")&&(t.style.display="none"),n=!1}),300))}e.onclick=function(e){e.stopPropagation(),t.classList.contains("open")?s():(t.style.display="block",t.classList.remove("close"),t.offsetHeight,t.classList.add("open"))},t.onclick=function(e){if(e.target.classList.contains("more-menu-item"))if("share"===e.target.dataset.action){if(z>=0&&G[z]){const e=G[z],t=encodeURIComponent(e.roomName||""),n=encodeURIComponent(e.password||""),s=`${location.origin}${location.pathname}?node=${t}&pwd=${n}`;navigator.clipboard?navigator.clipboard.writeText(s).then((()=>{window.addSystemMsg("Share link copied!")}),(()=>{prompt("Copy failed, url:",s)})):prompt("Copy failed, url:",s)}s()}else if("exit"===e.target.dataset.action){(function(){if(z>=0&&G[z]){const e=G[z].chat;return e&&"function"==typeof e.destruct?e.destruct():e&&"function"==typeof e.disconnect&&e.disconnect(),G[z].chat=null,G.splice(z,1),G.length>0&&(W(0),!0)}return!1})()||location.reload(),s()}},document.addEventListener("click",(function(n){t.contains(n.target)||n.target===e||s()})),t.addEventListener("animationend",(function(e){n=!1})),t.addEventListener("transitionend",(function(e){n=!1}))}function D(e){e&&(e.addEventListener("keydown",(function(e){(" "===e.key||/[\u0000-\u007f]/.test(e.key)&&/[\p{P}\p{S}]/u.test(e.key)&&"'"!==e.key)&&e.preventDefault()})),e.addEventListener("input",(function(t){e.value=e.value.replace(/[\s\p{P}\p{S}]/gu,(function(e){return"'"===e?"'":""}))})))}function K(e){return function(t){let n,s,i,o,r,a;t.preventDefault(),e?(n=document.getElementById("userName-modal").value.trim(),s=document.getElementById("roomName-modal").value.trim(),i=document.getElementById("password-modal").value.trim(),o=e.querySelector(".login-btn"),r=document.getElementById("roomName-modal")):(n=document.getElementById("userName").value.trim(),s=document.getElementById("roomName").value.trim(),i=document.getElementById("password").value.trim(),o=document.querySelector("#login-form .login-btn"),r=document.getElementById("roomName"));const c=G.some((e=>e.roomName&&e.roomName.toLowerCase()===s.toLowerCase()));if(r&&(r.style.border="",r.style.background="",r._warnTip&&(r.parentNode.removeChild(r._warnTip),r._warnTip=null)),c)return r&&(r.style.border="1.5px solid #e74c3c",r.style.background="#fff6f6",a=document.createElement("div"),a.style.color="#e74c3c",a.style.fontSize="13px",a.style.marginTop="4px",a.textContent="Node already exists",r.parentNode.appendChild(a),r._warnTip=a,r.focus()),void(o&&(o.disabled=!1,o.innerText="ENTER"));o&&(o.disabled=!0,o.innerText="Connecting..."),window.joinRoom(n,s,i,e,(function(e){!e&&o&&(o.disabled=!1,o.innerText="ENTER")}))}}function U(e=!1){const t=e?"-modal":"";return`\n\t\t<div class="input-group">\n\t\t\t<input id="userName${t}" type="text" autocomplete="username" required minlength="1" maxlength="15" placeholder="">\n\t\t\t<label for="userName${t}" class="floating-label">Username</label>\n\t\t</div>\n\t\t<div class="input-group">\n\t\t\t<input id="roomName${t}" type="text" required minlength="1" maxlength="15" placeholder="">\n\t\t\t<label for="roomName${t}" class="floating-label">Node Name</label>\n\t\t</div>\n\t\t<div class="input-group">\n\t\t\t<input id="password${t}" type="password" autocomplete="${e?"off":"current-password"}" minlength="1" maxlength="15" placeholder="">\n\t\t\t<label for="password${t}" class="floating-label">Node Password <span class="optional">(optional)</span></label>\n\t\t</div>\n\t\t<button type="submit" class="login-btn">ENTER</button>\n\t`}function V(){const e=document.createElement("div");e.className="login-modal",e.innerHTML=`<div class="login-modal-bg"></div><div class="login-modal-card"><button class="login-modal-close login-modal-close-abs">&times;</button><h1>Enter a Node</h1><form id="login-form-modal">${U(!0)}</form></div>`,document.body.appendChild(e),e.querySelector(".login-modal-close").onclick=()=>e.remove(),D(e.querySelector("#userName-modal")),D(e.querySelector("#roomName-modal")),D(e.querySelector("#password-modal"));e.querySelector("#login-form-modal").addEventListener("submit",K(e)),q("userName-modal")}function q(e=""){const t=new URLSearchParams(window.location.search),n=t.get("node"),s=t.get("pwd");if(n){const t=document.getElementById(e+"roomName");t&&(t.value=decodeURIComponent(n),t.readOnly=!0,t.style.background="#f5f5f5")}if(s){const t=document.getElementById(e+"password");t&&(t.value=decodeURIComponent(s),t.readOnly=!0,t.style.background="#f5f5f5")}(n||s)&&window.history.replaceState({},"",location.pathname)}let G=[],z=-1;function W(e){if(e<0||e>=G.length)return;z=e;const t=G[e];"number"==typeof t.unreadCount&&(t.unreadCount=0);const n=document.getElementById("sidebar-username");n&&(n.textContent=t.myUserName),Y(t.myUserName),Z(e),A(),j(!1),N(),B()}function Y(e){if(!e)return;const t=L(e),n=d("sidebar-user-avatar");if(n){const e=t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");n.innerHTML=e}}function Z(e=0){const t=d("room-list");t.innerHTML="",G.forEach(((n,s)=>{const i=u("div",{class:"room"+(s===e?" active":""),onclick:()=>W(s)}),o=x(n.roomName);let r="";n.unreadCount&&s!==e&&(r=`<span class="room-unread-badge">${n.unreadCount>99?"99+":n.unreadCount}</span>`),i.innerHTML=`<div class="info"><div class="title">#${o}</div></div>${r}`,t.appendChild(i)}))}function F(e,t){const n=G[e];if(!n)return;n.privateChatTargetId===t&&(n.privateChatTargetId=null,n.privateChatTargetName=null,z===e&&B());const s=n.userMap[t],i=`${s&&(s.userName||s.username||s.name)||"Anonymous"}left`;n.messages.push({type:"system",text:i}),z===e&&R(i,!0),n.userList=n.userList.filter((e=>e.clientId!==t)),delete n.userMap[t],z===e&&(j(!1),A())}function J(e){let t=d("status-bar");t||(t=u("div",{id:"status-bar",style:"color:green;padding:4px 10px;font-size:13px;"}),document.body.appendChild(t)),t.innerText=e}window.config={wsAddress:`${"https:"===window.location.protocol?"wss:":"ws:"}//${window.location.host}`,debug:!0},window.addSystemMsg=R,window.joinRoom=function(e,t,n,s=null,i){const o={roomName:"",userList:[],userMap:{},myId:null,myUserName:"",chat:null,messages:[],prevUserList:[],knownUserIds:new Set,unreadCount:0,privateChatTargetId:null,privateChatTargetName:null};o.roomName=t,o.myUserName=e,o.password=n,G.push(o);const r=G.length-1;W(r);const a=d("sidebar-username");a&&(a.textContent=e),Y(e);let c=!1;const l={onServerClosed:()=>{J("Node connection closed"),i&&!c&&(c=!0,i(!1))},onServerSecured:()=>{if(J("Secure connection to node"),s)s.remove();else{const e=d("login-container");e&&(e.style.display="none");const t=d("chat-container");t&&(t.style.display="")}i&&!c&&(c=!0,i(!0)),R("Server connection secured")},onClientSecured:e=>function(e,t){const n=G[e];if(!n)return;n.userMap[t.clientId]=t;const s=n.userList.findIndex((e=>e.clientId===t.clientId));-1===s?n.userList.push(t):n.userList[s]=t;z===e&&(j(!1),A());if(!n.isInitialized)return;const i=!n.knownUserIds.has(t.clientId);if(i){n.knownUserIds.add(t.clientId);const s=`${t.userName||t.username||t.name||"Anonymous"}joined`;n.messages.push({type:"system",text:s}),z===e&&R(s,!0),window.notifyMessage&&window.notifyMessage(n.roomName,"system",s)}}(r,e),onClientList:(e,t)=>function(e,t,n){const s=G[e];if(!s)return;const i=new Set((s.userList||[]).map((e=>e.clientId))),o=new Set(t.map((e=>e.clientId)));for(const r of i)o.has(r)||F(e,r);s.userList=t,s.userMap={},t.forEach((e=>{s.userMap[e.clientId]=e})),s.myId=n,z===e&&(j(!1),A());s.initCount=(s.initCount||0)+1,2===s.initCount&&(s.isInitialized=!0,s.knownUserIds=new Set(t.map((e=>e.clientId))))}(r,e,t),onClientLeft:e=>F(r,e),onClientMessage:e=>function(e,t){const n=G[e];if(!n)return;if(t.userName===n.myUserName&&!t.type.includes("_private")){const s=G[e];if(s&&t.clientId===s.myId&&t.type.includes("_private"));else if(t.clientId===n.myId)return}let s=t.type||"text";!s.includes("_private")&&t.data&&t.data.startsWith("data:image/")&&(s="image");let i=t.userName;!i&&t.clientId&&n.userMap[t.clientId]&&(i=n.userMap[t.clientId].userName||n.userMap[t.clientId].username||n.userMap[t.clientId].name);G[e].messages.push({type:"other",text:t.data,userName:i,avatar:i,msgType:s,timestamp:Date.now()});const o=s.includes("_private")?`private ${s.split("_")[0]}`:s;window.notifyMessage&&window.notifyMessage(n.roomName,o,t.data,i);z!==e?(G[e].unreadCount=(G[e].unreadCount||0)+1,Z(z)):N()}(r,e)},u=new window.NodeCrypt(window.config,l);u.setCredentials(e,t,n),u.connect(),G[r].chat=u},window.notifyMessage=function(e,t,n,s){const i=b();i.notify?function(e,t,n,s){if(!("Notification"in window)||"granted"!==Notification.permission)return;let i;const o=s?`${s}:`:"";"image"===n||"private image"===n?(i=`${o}[image]`,"private image"===n&&(i=`(Private)${i}`)):"text"===n||"private text"===n?(i=`${o}${E(t)}`,"private text"===n&&(i=`(Private)${i}`)):i=E(t),new Notification(`#${e}`,{body:i})}(e,n,t,s):i.sound&&function(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),n=e.createGain();t.frequency.value=1e3,t.connect(n),n.connect(e.destination),t.start(),n.gain.exponentialRampToValueAtTime(1e-4,e.currentTime+.5),setTimeout((()=>{t.stop(),e.close()}),600)}catch(e){console.error("Sound notification failed",e)}}()},window.setupEmojiPicker=v,window.addEventListener("DOMContentLoaded",(()=>{!function(){const e=document.getElementById("login-form");e&&(e.innerHTML=U(!1))}();const e=d("login-form");e&&e.addEventListener("submit",K(null));const t=l(".join-room");t&&(t.onclick=V),D(d("userName")),D(d("roomName")),D(d("password")),q(),$(),_(),O(),v(),b(),S();const n=d("settings-btn");n&&(n.onclick=e=>{e.stopPropagation(),function(){C();const e=d("settings-panel"),t=d("settings-btn");if(!t||!e)return;if("block"===e.style.display)return;const n=t.getBoundingClientRect();e.style.display="block";const s=l(".settings-panel-card",e);s&&(s.style.position="fixed",s.style.left=n.left+"px",s.style.top=n.bottom+8+"px",s.style.transform="translateX(0)",m(s,"close-anim"),s.offsetHeight,p(s,"open-anim"))}()}),document.addEventListener("click",(e=>{const t=d("settings-panel");if(t&&"block"===t.style.display){const n=t.querySelector(".settings-panel-card");n&&!n.contains(e.target)&&"settings-btn"!==e.target.id&&function(){const e=d("settings-panel");if(!e)return;const t=l(".settings-panel-card",e);t&&(m(t,"open-anim"),p(t,"close-anim"),setTimeout((()=>{e.style.display="none",m(t,"close-anim")}),300))}()}}));const s=document.querySelector(".input-message-input");s&&(s.focus(),s.addEventListener("keydown",(e=>{if("Enter"===e.key&&!e.shiftKey){e.preventDefault();const t=s.innerText.trim(),n=G[z];if(t&&n&&n.chat){if(n.privateChatTargetId){const e=n.chat.channel[n.privateChatTargetId];if(e&&e.shared){const s={a:"m",t:"text_private",d:t},i={a:"c",p:n.chat.encryptClientMessage(s,e.shared),c:n.privateChatTargetId},o=n.chat.encryptServerMessage(i,n.chat.serverShared);n.chat.sendMessage(o),T(t,!1,"text_private")}else R(`Cannot send private message to ${n.privateChatTargetName}.User might not be fully connected.`)}else n.chat.sendChannelMessage("text",t),T(t);s.innerText="",s.dispatchEvent(new Event("input"))}}}))),function({inputSelector:e,attachBtnSelector:t,fileInputSelector:n,onSend:s}){const i=l(e),o=l(t),r=l(n);r&&r.setAttribute("accept","image/*"),o&&r&&(h(o,"click",(()=>r.click())),h(r,"change",(async function(){if(!r.files||!r.files.length)return;const e=r.files[0];e.type.startsWith("image/")&&(e.size>5242880?alert(f("tooLarge")):(g(e,(e=>{"function"==typeof s&&s(e)})),r.value=""))}))),i&&h(i,"paste",(function(e){if(e.clipboardData)for(const t of e.clipboardData.items)if(t.type.startsWith("image/")){const n=t.getAsFile();if(!n)continue;if(n.size>5242880){alert(f("tooLarge"));continue}g(n,(e=>{"function"==typeof s&&s(e)})),e.preventDefault();break}}))}({inputSelector:".input-message-input",attachBtnSelector:".chat-attach-btn",fileInputSelector:'.new-message-wrapper input[type="file"]',onSend:e=>{const t=G[z];if(t&&t.chat)if(t.privateChatTargetId){const n=t.chat.channel[t.privateChatTargetId];if(n&&n.shared){const s={a:"m",t:"image_private",d:e},i={a:"c",p:t.chat.encryptClientMessage(s,n.shared),c:t.privateChatTargetId},o=t.chat.encryptServerMessage(i,t.chat.serverShared);t.chat.sendMessage(o),T(e,!1,"image_private")}else R(`Cannot send private image to ${t.privateChatTargetName}.User might not be fully connected.`)}else t.chat.sendChannelMessage("image",e),T(e,!1,"image")}});const i=()=>window.innerWidth<=768;A(),j(),function(){const e=document.getElementById("member-tabs").children;for(let t=0;t<e.length;t++)e[t].onclick=function(){for(let t=0;t<e.length;t++)e[t].classList.remove("active");this.classList.add("active")}}();const o=d("room-list"),r=d("sidebar"),a=d("rightbar"),c=d("mobile-sidebar-mask"),u=d("mobile-rightbar-mask");o&&o.addEventListener("click",(()=>{i()&&(null==r||r.classList.remove("mobile-open"),null==c||c.classList.remove("active"))}));const y=d("member-tabs");y&&y.addEventListener("click",(()=>{i()&&(m(a,"mobile-open"),m(u,"active"))}))}));
